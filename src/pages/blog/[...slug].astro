---
import BaseLayout from "@layouts/BaseLayout.astro";
import SiteNav from "@components/astro/SiteNav.astro";
import client from "@tina/__generated__/client";
import { BlogPost } from "@components/react/blog";

export async function getStaticPaths() {
  const blogConnection = await client.queries.blogConnection();
  const { edges } = blogConnection.data.blogConnection;
  return edges.map((edge) => {
    return {
      params: {
        slug: edge.node._sys.filename,
      },
      props: {
        relativePath: edge.node._sys.relativePath,
      },
    };
  });
}
const { relativePath } = Astro.props;
const post = await client.queries.blog({ relativePath });
const { title } = post.data.blog;
---

<BaseLayout {title}>
  <SiteNav />
  <BlogPost {post} />
</BaseLayout>
